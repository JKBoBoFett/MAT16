unit SaveDLGUnit;

interface

uses Windows, SysUtils, Classes, Graphics, Forms, Controls, StdCtrls,
  Buttons, ExtCtrls, mat_read;

type
  TMATSaveDlg = class(TForm)
    OKBtn:  TButton;
    Bevel1: TBevel;
    Save_OptionsRadioGroup: TRadioGroup;
    DitherRadioGroup1: TRadioGroup;
    mipCheckBox1: TCheckBox;
    procedure OKBtnClick(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure mipCheckBox1Click(Sender: TObject);
    procedure Save_OptionsRadioGroupClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  MATSaveDlg:  TMATSaveDlg;
  MatFileName: string;
// SaveChild: TMDIChild;

implementation

uses MAIN, options;

{$R *.dfm}

procedure TMATSaveDlg.OKBtnClick(Sender: TObject);
begin
  if isbatch then
  begin
    MainForm.DoBatchConvert();
  end;

  if not isbatch then
  begin
    if main.MainForm.imageList1.Count > 1 then
      ImageListtoMat16(main.MainForm.image1.Picture.Bitmap, main.MainForm.imagelist1,
        main.MainForm.SaveDialog.FileName, DitherRadioGroup1.ItemIndex)
    else
      BmptoMat16(main.MainForm.Image1.Picture.Bitmap, main.MainForm.SaveDialog.FileName,
        Save_OptionsRadioGroup.ItemIndex, DitherRadioGroup1.ItemIndex);

    MATSaveDlg.Hide;
  end;
  isbatch := False;
end;

procedure TMATSaveDlg.FormShow(Sender: TObject);
begin
  mipCheckBox1.Checked := Optionsform.CheckBox1.Checked;
end;

procedure TMATSaveDlg.mipCheckBox1Click(Sender: TObject);
begin
  if mipCheckBox1.Checked then
    Optionsform.CheckBox1.Checked := True

  else
    Optionsform.CheckBox1.Checked := False;


  if mipCheckBox1.Checked then
    Save_OptionsRadioGroup.ItemIndex := 1;

end;

procedure TMATSaveDlg.Save_OptionsRadioGroupClick(Sender: TObject);
begin
  if Save_OptionsRadioGroup.ItemIndex = 0 then
    mipCheckBox1.Checked := False;
end;

end.
